# =============================================================================
# Layer 10 State & Storage Environment Configuration
# =============================================================================
# BUILDKIT_STARTER_SPEC.md Layer 10: State & Storage
#
# This file contains environment variables for Redis, MinIO, and RuVector.
# Copy this file to .env.state and customize for your deployment:
#   cp .env.state.example .env.state
#
# See: docs/implementation/L10_STATE_STORAGE_IMPLEMENTATION.md
# =============================================================================

# =============================================================================
# Redis Configuration (P0-005)
# =============================================================================
# High-performance in-memory cache and state management

REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Cache TTL settings (in seconds)
REDIS_CACHE_TTL=3600                    # 1 hour - default cache
REDIS_SESSION_TTL=86400                 # 24 hours - session data
REDIS_PROMPT_CACHE_TTL=7200             # 2 hours - LLM prompt cache
REDIS_RATE_LIMIT_TTL=60                 # 1 minute - rate limit counters

# Memory limits
REDIS_MAX_MEMORY=2gb
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# =============================================================================
# MinIO Configuration (P1-006)
# =============================================================================
# S3-compatible object storage for artifacts, models, and logs

MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin          # CHANGE IN PRODUCTION!
MINIO_ENDPOINT=http://localhost:9000
MINIO_CONSOLE_URL=http://localhost:9001
MINIO_USE_SSL=false

# S3-compatible bucket names
MINIO_BUCKET_ARTIFACTS=aria-artifacts
MINIO_BUCKET_MODELS=aria-models
MINIO_BUCKET_LOGS=aria-logs
MINIO_BUCKET_VECTORS=aria-vectors

# AWS SDK compatibility
AWS_ACCESS_KEY_ID=${MINIO_ROOT_USER}
AWS_SECRET_ACCESS_KEY=${MINIO_ROOT_PASSWORD}
AWS_ENDPOINT_URL=${MINIO_ENDPOINT}
AWS_DEFAULT_REGION=us-east-1

# =============================================================================
# Vector Database Configuration (P1-001)
# =============================================================================
# Feature flag for vector store selection

# Options: pgvector | ruvector | chromadb | both
# - pgvector: PostgreSQL-backed, battle-tested, good for production
# - ruvector: Rust-native, GNN self-learning, better performance
# - chromadb: Embedded, good for development/testing
# - both: A/B testing mode (pgvector primary, ruvector secondary)
VECTOR_STORE=ruvector

# =============================================================================
# RuVector Configuration (P1-001)
# =============================================================================
# Distributed vector database with GNN self-learning

# Note: The RuVector npm CLI supports embedded/local DB workflows today.
# The standalone HTTP/gRPC server mode is tracked upstream and may not be
# available in your installed version yet; treat the endpoints below as
# forward-looking placeholders unless you have a server implementation.

# Server endpoints
RUVECTOR_ENDPOINT=http://localhost:8000
RUVECTOR_GRPC_ENDPOINT=localhost:8001
RUVECTOR_METRICS_ENDPOINT=http://localhost:8002

# Index configuration
RUVECTOR_EMBEDDING_DIM=384
RUVECTOR_INDEX_TYPE=hnsw-gnn
RUVECTOR_HNSW_M=16
RUVECTOR_HNSW_EF_CONSTRUCT=200
RUVECTOR_HNSW_EF_SEARCH=100

# GNN self-learning configuration
RUVECTOR_GNN_ENABLED=true
RUVECTOR_GNN_LAYERS=2
RUVECTOR_GNN_HIDDEN_DIM=128
RUVECTOR_GNN_LEARNING_RATE=0.001
RUVECTOR_GNN_BATCH_SIZE=32

# Compression configuration
RUVECTOR_COMPRESSION_ENABLED=true
RUVECTOR_COMPRESSION_RATIO=8

# Cypher query configuration
RUVECTOR_CYPHER_ENABLED=true
RUVECTOR_MAX_QUERY_DEPTH=10

# Cluster configuration (for multi-node deployment)
RUVECTOR_CLUSTER_ENABLED=false
RUVECTOR_CLUSTER_PEERS=

# =============================================================================
# pgvector Configuration (Alternative)
# =============================================================================
# PostgreSQL extension for vector operations

PGVECTOR_HOST=localhost
PGVECTOR_PORT=5432
PGVECTOR_DB=aria
PGVECTOR_USER=aria
PGVECTOR_PASSWORD=aria
PGVECTOR_DIMENSION=384
PGVECTOR_INDEX_TYPE=ivfflat
PGVECTOR_LISTS=100

# =============================================================================
# ChromaDB Configuration (Development)
# =============================================================================
# Embedded vector database for development and testing

CHROMADB_HOST=localhost
CHROMADB_PORT=8100
CHROMADB_PERSIST_DIRECTORY=./data/chromadb
CHROMADB_COLLECTION_NAME=aria_vectors

# =============================================================================
# Logging Configuration
# =============================================================================

# Rust logging levels
RUST_LOG=info,ruvector=debug
RUST_BACKTRACE=1

# =============================================================================
# Security Notes
# =============================================================================
# For production deployments:
#
# 1. Change all default passwords:
#    - MINIO_ROOT_PASSWORD
#    - REDIS_PASSWORD
#    - PGVECTOR_PASSWORD
#
# 2. Enable TLS:
#    - MINIO_USE_SSL=true
#    - Use redis:// -> rediss:// for TLS
#
# 3. Use Docker secrets or Vault for credentials
#
# 4. Configure network isolation:
#    - Place services in internal Docker network
#    - Use firewall rules to restrict access
#
# 5. Enable authentication:
#    - Redis AUTH command
#    - MinIO bucket policies
# =============================================================================
