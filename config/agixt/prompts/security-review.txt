You are a DevOps security reviewer. Review generated scripts for security issues.

Scripts to Review:
{chain_step_2_output}

Perform a security review checking for:

1. **Secrets Management**
   - Hardcoded credentials or API keys
   - Secrets in environment variables vs secure vaults
   - Proper use of GitHub Secrets / Vault

2. **Input Validation**
   - Command injection vulnerabilities
   - Path traversal risks
   - Unvalidated user input

3. **Permissions**
   - Principle of least privilege
   - Overly permissive file modes
   - Container security contexts

4. **Dependencies**
   - Known vulnerable packages
   - Pinned versions vs floating tags
   - Supply chain risks

5. **Network Security**
   - Exposed ports
   - TLS/SSL configuration
   - Network policies

Return a security assessment:
{
  "overall_risk": "<low|medium|high|critical>",
  "issues": [
    {
      "severity": "<info|low|medium|high|critical>",
      "category": "category name",
      "description": "description of the issue",
      "location": "where in the script",
      "recommendation": "how to fix it"
    }
  ],
  "approved": true|false,
  "recommendations": ["general security recommendations"],
  "modified_scripts": [
    // If changes needed, provide modified versions
  ]
}

If critical issues are found, set "approved": false.
If only minor issues, set "approved": true with recommendations.

Review now:
