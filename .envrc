# ros2-humble-env direnv configuration
# This file automatically loads the development environment
#
# Usage:
#   direnv allow    # Enable this environment
#   direnv reload   # Reload after changes
#
# For more info: https://direnv.net/

# =============================================================================
# Temporary Directory Setup
# =============================================================================
# Some environments set TMPDIR/TMP/TEMP to a path that may not exist.
# Nix (and some installers) rely on these being valid directories.
if [[ -z "${TMPDIR:-}" ]]; then
  export TMPDIR=/tmp
fi
if [[ ! -d "${TMPDIR}" ]]; then
  mkdir -p "${TMPDIR}" 2>/dev/null || export TMPDIR=/tmp
fi
export TMP="${TMPDIR}"
export TEMP="${TMPDIR}"

# =============================================================================
# Nix Flake Development Shell
# =============================================================================
# This loads the default devShell from flake.nix
# For alternative shells use: use flake .#full or use flake .#cuda
use flake

# =============================================================================
# Environment Variables
# =============================================================================
# Load .env file if it exists (for secrets and local overrides)
if [[ -f .env ]]; then
  dotenv .env
fi

# Default editor (Helix)
export EDITOR="${EDITOR:-hx}"
export VISUAL="${VISUAL:-hx}"

# LocalAI models directory
export LOCALAI_MODELS_PATH="${LOCALAI_MODELS_PATH:-$HOME/.local/share/localai/models}"

# AIOS Agent OS
export AIOS_DIR="${AIOS_DIR:-$HOME/.local/share/aios}"
export AIOS_PORT="${AIOS_PORT:-8000}"

# PromptCache
export PROMPTCACHE_DIR="${PROMPTCACHE_DIR:-$HOME/.local/share/prompt-cache}"
export PROMPTCACHE_PORT="${PROMPTCACHE_PORT:-8080}"

# =============================================================================
# Local Overrides
# =============================================================================
# Optional: Source local overrides if they exist
# Create .envrc.local for machine-specific configuration
if [[ -f .envrc.local ]]; then
  source .envrc.local
fi

# =============================================================================
# ROS2 Workspace Layout (optional)
# =============================================================================
# Uncomment these if you're in a ROS2 workspace:
# layout ros2
# layout colcon
